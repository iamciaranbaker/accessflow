(()=>{var e={767:()=>{const e=document.querySelector(".form-control.is-invalid");e&&e.focus()},542:()=>{$(".card-explain").popover({trigger:"hover",animation:!0,delay:{show:100,hide:100}})},213:()=>{const e=document.querySelector(".main-header"),t=document.querySelector(".content-header"),n=document.querySelector(".main-footer");document.querySelector(".job-logs");if(e&&t&&n){const o=window.innerHeight-e.offsetHeight-t.offsetHeight-n.offsetHeight-16,r=document.querySelector(".job-logs"),i=document.querySelector(".user-permissions");r&&(r.style.maxHeight=o+"px",r.scrollTop=r.scrollHeight),i&&(i.style.maxHeight=o+"px")}},894:()=>{if(window.location.pathname.toLowerCase().startsWith("/requests/create")){const o=new URLSearchParams(window.location.search),r=o.get("type");if(o&&r&&("account_creation"==r||"service_access"==r)){const i=document.querySelector('select[name="environments"]'),s=document.querySelector('input[name="nonprod_pid"]'),a=document.querySelector('textarea[name="nonprod_ssh_key"]'),l=document.querySelector('input[name="prod_pid"]'),d=document.querySelector('textarea[name="prod_ssh_key"]'),c=document.querySelectorAll('input[name="sc_clearance"]'),u=s.closest(".form-group"),m=l.closest(".form-group"),p=c[0]?.closest(".form-group");if("account_creation"==r&&a)var e=a.closest(".form-group");if("account_creation"==r&&d)var t=d.closest(".form-group");const f=s.getAttribute("minlength"),b=s.getAttribute("maxlength"),h=l.getAttribute("minlength"),g=l.getAttribute("maxlength");function n(){const n=Array.from(i.selectedOptions).map((e=>e.value));n.includes("nonprod")?(u.style.display="block",s.setAttribute("required",""),s.setAttribute("minlength",f),s.setAttribute("maxlength",b),"account_creation"==r&&(e.style.display="block",s.setAttribute("required",""))):(u.style.display="none",s.removeAttribute("required"),s.removeAttribute("minlength"),s.removeAttribute("maxlength"),"account_creation"==r&&(e.style.display="none",s.removeAttribute("required"))),n.includes("prod")?(m.style.display="block",l.setAttribute("required",""),l.setAttribute("minlength",h),l.setAttribute("maxlength",g),"account_creation"==r&&(t.style.display="block",l.setAttribute("required","")),p.style.display="block",c.forEach((e=>e.setAttribute("required","")))):(m.style.display="none",l.removeAttribute("required"),l.removeAttribute("minlength"),l.removeAttribute("maxlength"),"account_creation"==r&&(t.style.display="none",l.removeAttribute("required")),p.style.display="none",c.forEach((e=>e.removeAttribute("required"))))}$(".select2").select2(),n(),$(i).on("change",n)}}},36:()=>{const e=document.querySelector(".filter");e&&e.addEventListener("click",(function(e){e.preventDefault(),function(e,t=[]){$(e).popover("dispose");let n="";t.forEach((e=>{n+=`\n            <div class="form-group mb-1">\n                <label class="col-form-label" for="${e.name}">${e.label}</label>\n                <select name="${e.name}" class="form-control form-control-sm select2" multiple>\n                    ${e.options.map((e=>`\n                        <option value="${e.value}">${e.label}</option>\n                    `)).join("")}\n                </select>\n            </div>\n        `}));const o=`\n        <div>\n            <form style="min-width: 250px">\n                ${n}\n                <button type="submit" class="btn btn-primary btn-sm btn-block mt-3">Apply Filter(s)</button>\n            </form>\n        </div>\n    `;$(e).popover({html:!0,content:o,title:"Apply Filter(s)",placement:"bottom",container:"body",trigger:"manual",animation:!0,sanitize:!1}),$(e).popover("show");const r=e.getAttribute("aria-describedby"),i=document.getElementById(r);if(!i)return;const s=$("#"+r),a=s.find("form"),l=new URLSearchParams(window.location.search);function d(t){i.contains(t.target)||e.contains(t.target)||($(e).popover("hide"),document.removeEventListener("mousedown",d))}t.forEach((e=>{const t=l.getAll(`filter[${e.name}]`),n=s.find(`select[name="${e.name}"]`);n.find("option").each((function(){t.includes(this.value)&&$(this).prop("selected",!0)})),n.select2({dropdownParent:s,closeOnSelect:!0,theme:"bootstrap4"})})),a.on("submit",(function(e){e.preventDefault();const t=new FormData(this),n=new URLSearchParams,o=new URLSearchParams(window.location.search);for(const[e,t]of o.entries())e.startsWith("filter[")||"page"===e||n.append(e,t);for(const[e,o]of t.entries())o.trim()&&n.append(`filter[${e}]`,o.trim());const r=n.toString();window.location.href=r?`${window.location.pathname}?${r}`:window.location.pathname})),setTimeout((()=>{document.addEventListener("mousedown",d)}),0),$(e).on("hidden.bs.popover",(function(){$(e).popover("dispose")}))}(this,filterOptions)}))},367:()=>{const e={success:"success",danger:"error",warning:"warning",info:"info"};toastr.options={closeButton:!0,progressBar:!0,positionClass:"toast-top-right",timeOut:"10000"};const t=document.getElementById("flash-messages");if(t){t.querySelectorAll(".flash-message").forEach((t=>{const n=t.dataset.category,o=t.textContent.trim();toastr[e[n]||"info"](o)})),t.remove()}},188:()=>{if(window.location.pathname.toLowerCase().startsWith("/admin/jobs/logs")){const n=document.querySelector(".job-logs table tbody"),o=document.querySelector(".job-logs"),r=document.querySelector(".job-status"),i=document.querySelector(".job-duration"),s=document.querySelector(".job-finished-at");if(n&&o&&r&&"Running"===r.textContent.trim()){const a=new URLSearchParams(window.location.search),l=a.get("id"),d=a.get("run_id");let c=n.querySelectorAll("tr:not(.log-loading)").length,u=!0;function e(){const e=document.querySelector(".log-loading");if(e)n.appendChild(e);else{const e=document.createElement("tr");e.classList.add("log-loading"),e.innerHTML='\n                    <td class="align-middle text-right text-muted" style="width: 5%"></td>\n                    <td class="align-middle pl-2 text-muted">\n                        <span class="loading-dots"></span>\n                    </td>\n                ',n.appendChild(e)}}function t(){fetch(`/admin/jobs/logs?id=${l}&run_id=${d}&offset=${c}`).then((e=>e.json())).then((t=>{t.logs&&t.logs.length>0&&(t.logs.forEach(((e,t)=>{const o=document.createElement("tr");o.innerHTML=`\n                                <td class="align-middle text-right text-muted" style="width: 5%">\n                                    ${c+t+1}\n                                </td>\n                                <td class="align-middle pl-2 log-${e.level.toLowerCase()}">\n                                    ${e.created_at} - [ ${e.level} ] - ${e.message}\n                                </td>\n                            `,n.appendChild(o)})),c+=t.logs.length,o.scrollTop=o.scrollHeight),u&&e();const a=t.status||"";if(a&&"Running"!==a){!function(e,t){const n={succeeded:'<span class="text-success"><i class="fas fa-check-circle"></i> Succeeded</span>',failed:'<span class="text-danger"><i class="fas fa-times-circle"></i> Failed</span>'}[e.toLowerCase()];if(n&&(r.innerHTML=n),t.duration&&i){i.style.display="";const e=i.querySelector("td:last-child");e&&(e.textContent=t.duration)}if(t.finished_at&&s){s.style.display="";const e=s.querySelector("td:last-child");e&&(e.textContent=t.finished_at)}}(a,t);const e=document.querySelector(".log-loading");e&&e.remove(),u=!1}}))}e();const m=setInterval((()=>{u?t():clearInterval(m)}),1e3)}}},630:()=>{var e=document.querySelectorAll(".paginate-goto");e&&e.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),function(e){$(e).popover("dispose");const t=e.getAttribute("data-page"),n=e.getAttribute("data-page-max"),o=`\n        <div class="input-group">\n            <input type="number" class="form-control" id="pageNumberInput" min="1" max="${n}" value="${t}" step="1">\n            <div class="input-group-append">\n                <button class="btn btn-default" type="button" id="paginate-page-plus">\n                    <i class="fas fa-plus"></i>\n                </button>\n                <button class="btn btn-default" type="button" id="paginate-page-minus">\n                    <i class="fas fa-minus"></i>\n                </button>\n            </div>\n        </div>\n        <button class="btn btn-primary btn-sm btn-block mt-2" id="paginate-page-go">Go To Page</button>\n    `;$(e).popover({html:!0,content:o,title:"Go To Page",placement:"top",container:"body",trigger:"manual",animation:!0,sanitize:!1}),$(e).popover("show");const r=e.getAttribute("aria-describedby"),i=document.getElementById(r);if(!i)return;const s=i.querySelector("input"),a=i.querySelector("#paginate-page-plus"),l=i.querySelector("#paginate-page-minus"),d=i.querySelector("#paginate-page-go");function c(t){i.contains(t.target)||e.contains(t.target)||($(e).popover("hide"),document.removeEventListener("mousedown",c))}a.addEventListener("click",(()=>{let e=parseInt(s.value)||1;s.value=Math.min(n,e+1)})),l.addEventListener("click",(()=>{let e=parseInt(s.value)||1;s.value=Math.max(1,e-1)})),d.addEventListener("click",(()=>{const e=parseInt(s.value)||1,t=new URL(window.location.href),n=new URLSearchParams(t.search),o=new URLSearchParams;1!==e&&o.set("page",e);for(const[e,t]of n.entries())"page"!==e&&o.append(e,t);window.location.href=`${t.pathname}?${o.toString()}`})),setTimeout((()=>{document.addEventListener("mousedown",c)}),0),$(e).on("hidden.bs.popover",(function(){$(e).popover("dispose")}))}(e.currentTarget)}))}))},517:()=>{var e=document.querySelectorAll(".toggle-password");e&&e.forEach((function(e){e.setAttribute("title","Reveal "+e.getAttribute("data-tooltip")),e.addEventListener("click",(function(){var t=e.closest(".input-group").querySelector("input"),n=e.querySelector("i");"password"===t.type?(t.type="text",n.classList.remove("fa-eye"),n.classList.add("fa-eye-slash"),e.setAttribute("title","Conceal "+e.getAttribute("data-tooltip"))):(t.type="password",n.classList.remove("fa-eye-slash"),n.classList.add("fa-eye"),e.setAttribute("title","Reveal "+e.getAttribute("data-tooltip")))}))}))},43:()=>{if(window.location.pathname.toLowerCase().startsWith("/admin/requests")){const o=document.querySelectorAll('input[type="radio"][name="selected_pid_nonprod"]'),r=document.querySelectorAll('input[type="radio"][name="selected_pid_prod"]'),i=document.getElementById("host-group-matches"),s=document.getElementById("pid-matches");function e(e){const t=e.closest("tr"),n=t?.querySelector("td .d-block");return n?n.textContent.trim():null}function t(e,t,n="exclamation-triangle"){const o=document.createElement("div");return o.className=`row warning-box ${e}`,o.innerHTML=`\n            <div class="col-12">\n                <div class="alert alert-warning">\n                    <i class="icon fas fa-${n}"></i> ${t}\n                </div>\n            </div>\n        `,o}function n(n){const o=n.name.includes("nonprod")?"nonprod":"prod";!function(e,t){if(!i)return;i.querySelectorAll("tbody tr").forEach((n=>{const o=n.querySelector("span.badge");if(!o)return;if((o.classList.contains("bg-success")?"nonprod":o.classList.contains("bg-danger")?"prod":null)!==t)return;const r=n.querySelectorAll("td"),i=r[2],s=r[3];let a=!1,l=!1;i.querySelectorAll("code[data-pid-id]").forEach((t=>{const n=t.getAttribute("data-pid-id")===e;t.style.display=n?"inline-block":"none",n&&(a=!0)})),s.querySelectorAll("code[data-pid-id]").forEach((t=>{const n=t.getAttribute("data-pid-id")===e;t.style.display=n?"inline-block":"none",n&&(l=!0)})),n.style.display=a&&l?"":"none"}))}(n.value,o),function(){const n=document.querySelector('input[name="selected_pid_nonprod"]:checked'),o=document.querySelector('input[name="selected_pid_prod"]:checked'),r=document.querySelector(".content .container-fluid"),i=r.querySelector(".pid-name-mismatch");if(n&&o){const s=e(n),a=e(o);if(s&&a&&s!==a){if(!i){const e=t("pid-name-mismatch","The selected Non-Production PID and Production PID have different names. Are you sure they're the same person?");r.prepend(e)}}else i?.remove()}else i?.remove()}(),function(){const e=document.querySelector(".content .container-fluid");e.querySelectorAll(".confidence-warning-nonprod, .confidence-warning-prod").forEach((e=>e.remove()));const n=[];["nonprod","prod"].forEach((e=>{const o=document.querySelector(`input[name="selected_pid_${e}"]:checked`);if(o){const r=o.closest("tr"),i=r?.querySelectorAll("td")[3],s=i?.textContent?.trim().replace("%",""),a=parseInt(s,10);if(!isNaN(a)&&a<85){const o=t(`confidence-warning-${e}`,`The selected ${"nonprod"===e?"Non-Production":"Production"} PID has a confidence rating below 85%. Are you sure this is the correct person?`);n.push(o)}}})),n.reverse().forEach((t=>{e.prepend(t)}))}()}[...o,...r].forEach((e=>{e.checked&&n(e),e.addEventListener("change",(function(){this.checked&&n(this)}))})),s&&s.querySelectorAll("tbody tr").forEach((e=>{e.addEventListener("click",(function(){const e=this.querySelector('input[type="radio"]');e&&!e.checked&&(e.checked=!0,e.dispatchEvent(new Event("change")))}))})),document.getElementById("request-approve").addEventListener("click",(function(e){e.preventDefault(),function(e){const t=document.querySelector('input[name="selected_pid_nonprod"]:checked'),n=document.querySelector('input[name="selected_pid_prod"]:checked'),o=Array.from(document.querySelectorAll("#host-group-matches tbody tr")).filter((e=>"none"!==getComputedStyle(e).display));function r(e,t){if(!t)return"";const{name:n,pid:r,team:i,confidence:s}=function(e){const t=e.closest("tr");return{name:t.querySelector(".d-block")?.textContent.trim()||"Unknown",pid:t.querySelector(".small")?.textContent.trim()||"Unknown",team:t.querySelectorAll("td")[1]?.textContent.trim()||"-",confidence:t.querySelectorAll("td")[3]?.textContent.trim()||"-"}}(t),a="nonprod"===e?"success":"danger",l="nonprod"===e?"Non-Production":"Production",d=o.filter((e=>{const t=e.querySelector("span.badge");return t&&t.classList.contains(`bg-${a}`)})).map((e=>{const t=e.querySelectorAll("td"),n=t[0]?.textContent.trim();return`\n                    <div class="service-card border rounded p-3 mb-3 shadow-sm">\n                        <table class="table table-sm table-borderless mb-0">\n                            <tbody>\n                                <tr>\n                                    <td class="align-middle font-weight-bold" width="20%">Service</td>\n                                    <td class="align-middle" width="80%">${n}</td>\n                                <tr>\n                                    <td class="align-middle font-weight-bold" width="20%">Environments</td>\n                                    <td class="align-middle" width="80%">${Array.from(t[2]?.querySelectorAll("code")).filter((e=>"none"!==e.style.display)).map((e=>`<code class="mr-1">${e.textContent}</code>`)).join("")||"<em>None</em>"}</td>\n                                </tr>\n                                <tr>\n                                    <td class="align-middle font-weight-bold" width="20%">Host Groups</td>\n                                    <td class="align-middle" width="80%">${Array.from(t[3]?.querySelectorAll("code")).filter((e=>"none"!==e.style.display)).map((e=>`<code class="mr-1">${e.textContent}</code>`)).join("")||"<em>None</em>"}</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </div>\n                `})).join("");return`\n                <section class="mb-4">\n                    <div class="border-start border-${a} ps-3 mb-3">\n                        <div class="service-card border rounded p-3 mb-3 bg-light shadow-sm">\n                            <table class="table table-sm table-borderless mb-0">\n                                <tbody>\n                                    <tr>\n                                        <td class="align-middle font-weight-bold" width="20%">PID</td>\n                                        <td class="align-middle" width="80%">${r}</td>\n                                    </tr>\n                                    <tr>\n                                        <td class="align-middle font-weight-bold" width="20%">Name</td>\n                                        <td class="align-middle" width="80%">${n}</td>\n                                    </tr>\n                                    <tr>\n                                        <td class="align-middle font-weight-bold" width="20%">Team</td>\n                                        <td class="align-middle" width="80%">${i}</td>\n                                    </tr>\n                                    <tr>\n                                        <td class="align-middle font-weight-bold" width="20%">Environment Type</td>\n                                        <td class="align-middle" width="80%">\n                                            <span class="badge bg-${a}">\n                                                ${l}\n                                            </span>\n                                        </td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                    <div class="offset-1">\n                        ${d||"<p class='text-muted'><em>No applicable services for this PID.</em></p>"}\n                    </div>\n                </section>\n            `}const i=`\n            <div class="modal fade" id="approve-request-modal">\n                <div class="modal-dialog modal-xl">\n                    <div class="modal-content">\n                        <div class="modal-header">\n                            <h4 class="modal-title">Approve Request </h4>\n                            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">\n                                <span aria-hidden="true">&times;</span>\n                            </button>\n                        </div>\n                        <div class="modal-body overflow-auto pb-0" style="max-height: 70vh;">\n                            <p>Are you sure you want to approve this request?</p>\n                            <p>By approving this request, you will grant the following access:</p>\n                            ${r("nonprod",t)}\n                            ${r("prod",n)}\n                        </div>\n                        <div class="modal-footer justify-content-between">\n                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>\n                            <button type="button" class="btn btn-success">Approve Request</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;document.body.insertAdjacentHTML("beforeend",i),$("#approve-request-modal").modal("show"),document.querySelector("#approve-request-modal .btn-success").addEventListener("click",(function(){window.location.href=e})),$("#approve-request-modal").on("hidden.bs.modal",(function(){$(this).remove()}))}("/admin/requests/edit?id=1")}))}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}(()=>{"use strict";var e=document.querySelector("[data-widget='pushmenu']");function t(){var e,t,n=document.querySelector("body").classList.contains("sidebar-collapse");document.querySelectorAll(".nav-sidebar .nav-link").forEach((e=>{n?e.setAttribute("title",e.getAttribute("data-tooltip")):e.removeAttribute("title")})),e="sidebarCollapsed",t=n,document.cookie=`${e}=${t}; path=/`}e&&e.addEventListener("click",(function(){setTimeout(t,100)})),"true"!==function(e){const t=`; ${document.cookie}`.split(`; ${e}=`);if(2===t.length)return t.pop().split(";").shift()}("sidebarCollapsed")||document.body.classList.contains("sidebar-collapse")||e.click(),t();n(517);function o(e,t,n,o,r=!1,i=""){let s="";s=r?`\n            <p>${t}</p>\n            <p>Type the following to confirm:</p>\n            <code>${i}</code>\n            <input type="text" class="form-control mt-4" required>\n        `:`\n            <p class="mb-0">${t}</p>\n        `;const a=`\n        <div class="modal fade" id="confirmation-modal">\n            <div class="modal-dialog modal-lg">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h4 class="modal-title">${e}</h4>\n                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                            <span aria-hidden="true">&times;</span>\n                        </button>\n                    </div>\n                    <div class="modal-body">\n                        ${s}\n                    </div>\n                    <div class="modal-footer justify-content-between">\n                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>\n                        <button type="button" class="btn btn-danger">${n}</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;document.body.insertAdjacentHTML("beforeend",a);var l=document.querySelector("#confirmation-modal .modal-footer .btn-danger");if(r){var d=document.querySelector("#confirmation-modal .modal-body input");l.disabled=!0,d.addEventListener("input",(function(){d.value===i?l.disabled=!1:l.disabled=!0}))}$("#confirmation-modal").modal("show"),l.addEventListener("click",(function(){l.disabled||(window.location.href=o)})),$("#confirmation-modal").on("hidden.bs.modal",(function(){$(this).remove()}))}function r(e,t,n){o(`Delete ${e}`,`Are you sure you want to delete this ${e.toLowerCase()}?`,`Delete ${e}`,t,!0,n)}var i=document.querySelectorAll(".user-delete");i&&i.forEach((function(e){e.addEventListener("click",(function(e){var t=e.target.closest("tr");r("User",`/admin/users/delete?id=${t.getAttribute("data-user-id")}`,t.getAttribute("data-user-email-address"))}))}));var s=document.querySelectorAll(".service-delete");s&&s.forEach((function(e){e.addEventListener("click",(function(e){var t=e.target.closest("tr");r("Service",`/admin/services/delete?id=${t.getAttribute("data-service-id")}`,t.getAttribute("data-service-name"))}))}));n(767),n(367),n(213),n(630),n(36),n(894);const a=document.querySelector(".request-decline");a&&a.addEventListener("click",(function(e){e.preventDefault(),o("Decline Request","Are you sure you want to decline this request?","Decline Request","",!1)}));n(43),n(542),n(188)})()})();